# Plan: Fix Missing CSS on Dynamic Site Pages

**Overall Goal:** Fix the missing CSS styling on dynamic site-specific pages (`src/pages/websites/[urlPath].astro`).

**Diagnosis:** The core issue identified is that Astro is not generating or linking the necessary CSS bundle (e.g., `/_astro/index.CgRM8XXB.css`) for the dynamic pages, while it does for the static `index.astro` page. This happens despite various attempts to import or link `globals.css`.

**Systematic Troubleshooting Plan:**

1.  **Establish Baseline Code State:**
    *   Ensure `astro.config.mjs` has `applyBaseStyles: false`.
    *   Ensure `src/layouts/Layout.astro` does *not* import or link `globals.css`.
    *   Ensure both `src/pages/index.astro` and `src/pages/websites/[urlPath].astro` directly import `globals.css` (using the correct relative path).
    *   Use `await entry.render()` in `[urlPath].astro`, ignoring the persistent TS error for now.
    *   *Rationale:* This configuration mirrors the working `index.astro` page and is the most standard way to handle CSS imports per-page when `applyBaseStyles` is false. This consistency is crucial for the next analysis step.
2.  **Analyze Build Process (Verbose):**
    *   Run `npx astro build --verbose`.
    *   Compare the verbose log output for `index.astro` vs. a dynamic page generated by `[urlPath].astro`.
    *   Look for differences in CSS dependency discovery, processing, chunking, and final `<link>` tag generation.
    *   *Rationale:* This should reveal *where* in Astro's pipeline the process diverges for dynamic routes, leading to the missing CSS link.
3.  **Research Astro Internals/Issues:**
    *   Based on build log analysis, search Astro's GitHub issues, documentation, and community forums for similar problems related to CSS bundling, dynamic routes (`getStaticPaths`), content collections (`entry.render()`), and the Tailwind integration, especially with `applyBaseStyles: false`.
    *   Keywords: "Astro CSS dynamic route missing", "Astro getStaticPaths CSS bundle", "Astro Tailwind applyBaseStyles false", "Astro content collection CSS".
    *   *Rationale:* Others may have encountered this specific interaction, potentially revealing known bugs, workarounds, or configuration nuances.
4.  **Hypothesize and Test:**
    *   Formulate a specific hypothesis based on the analysis (e.g., "Astro fails to detect styles used within the `<Content />` component from `entry.render()` for dynamic routes").
    *   Devise a targeted test or modification based on the hypothesis. This might involve:
        *   Trying a different way to render content.
        *   Explicitly adding a known styled component to `[urlPath].astro` outside the `<Content />` to see if *that* triggers CSS bundling.
        *   Experimenting with Vite configuration options within `astro.config.mjs` related to CSS.
    *   *Rationale:* Move from broad configuration changes to targeted fixes based on evidence.
5.  **Implement Solution:** Apply the fix identified through testing.
6.  **Verify:** Confirm styling works correctly on dynamic pages.